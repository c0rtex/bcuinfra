var app=angular.module("ncoa",["ngAnimate","ngRoute","LocalStorageModule","ui.router","angular-loading-bar"]);app.config(["cfpLoadingBarProvider",function(cfpLoadingBarProvider){cfpLoadingBarProvider.includeSpinner=!1}]),app.config(function(localStorageServiceProvider){localStorageServiceProvider.setStorageType("sessionStorage")}),app.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("prescreen",{url:"/",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/prescreen/prescreen.questions.html?"+new Date,controller:"preScreenController"}).state("prescreen.questions",{url:"prescreen/questions",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/prescreen/prescreen.questions.html?"+new Date,controller:"preScreenController"}).state("prescreen.results",{url:"prescreen/results",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/prescreen/prescreen.results.html?"+new Date,controller:"preScreenResultsController"}).state("questionnaire.initial-results",{url:"/results/initial",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.initial-results.html?"+new Date,controller:"questionnairePrescreenResultsController",data:{next:"questionnaire.basics",prev:"/"}}).state("questionnaire",{url:"/questionnaire",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.html?"+new Date,controller:"questionnaireController",data:{next:"questionnaire.health",prev:"prescreen.results"}}).state("questionnaire.basics",{url:"/basics",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.basics.html?"+new Date,controller:"questionnaireBasicController",data:{next:"questionnaire.health",prev:"prescreen.results"}}).state("questionnaire.health",{url:"/health",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.health.html?"+new Date,controller:"questionnaireHealthController",data:{next:"questionnaire.household",prev:"questionnaire.basics"}}).state("questionnaire.household",{url:"/household",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.household.html?"+new Date,controller:"questionnaireHouseholdController",data:{next:"questionnaire.finances",prev:"questionnaire.health"}}).state("questionnaire.finances",{url:"/finances",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.finances.html?"+new Date,controller:"questionnaireFinancesController",data:{next:"questionnaire.finances-income",prev:"questionnaire.household"}}).state("questionnaire.finances-income",{url:"/finances/income",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.finances.income.html?"+new Date,controller:"questionnaireFinancesController",data:{next:"questionnaire.finances-income-grid",prev:"questionnaire.finances"}}).state("questionnaire.finances-income-grid",{url:"/finances/income-grid",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.finances.income-grid.html?"+new Date,controller:"questionnaireFinancesController",data:{next:"questionnaire.finances-assets",prev:"questionnaire.finances-income"}}).state("questionnaire.finances-assets",{url:"/finances/assets",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.finances.assets.html?"+new Date,controller:"questionnaireFinancesController",data:{next:"questionnaire.finances-assets-grid",prev:"questionnaire.finances-income-grid"}}).state("questionnaire.finances-assets-grid",{url:"/finances/assets-grid",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.finances.assets-grid.html?"+new Date,controller:"questionnaireFinancesController",data:{next:"questionnaire.loader",prev:"questionnaire.finances-assets"}}).state("questionnaire.results",{url:"/results",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/questionnaire/questionnaire.results.html?"+new Date,controller:"questionnaireResultsController",data:{next:"",prev:"questionnaire.finances-assets-grid"}}).state("questionnaire.loader",{url:"/loader",templateUrl:"/content/themes/ncoa/resources/views/pages/loader.html?"+new Date,controller:"questionnaireLoaderController",data:{next:"",prev:""}}).state("fact-sheets",{url:"/fact-sheets/:programCode/:stateId/:short/:zipcode/:elegible",templateUrl:function($stateParams){return"y"==$stateParams.short?"/fact-sheets/factsheet_"+$stateParams.programCode+"/?state="+$stateParams.stateId+"&short_layout=y&short=y&zipcode="+$stateParams.zipcode+"&elegible="+$stateParams.elegible:"/fact-sheets/factsheet_"+$stateParams.programCode+"/?state="+$stateParams.stateId+"&short_layout=y&zipcode="+$stateParams.zipcode+"&elegible="+$stateParams.elegible}}).state("screening-start",{url:"/screening-start",controller:"screeningController"}).state("screening",{url:"/screening/:category/:state",templateUrl:"/content/themes/ncoa/resources/views/pages/benefits-checkup/screening/screening.html?"+new Date,controller:"screeningController",data:{next:"",prev:""}})}]).run(["$rootScope",function($rootScope){$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){var test=document.querySelector("body");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top+"px"},0)})}]),app.directive("completeQuestionnaire",["$state","$window","prescreen",function($state,$window,prescreen){return{restrict:"E",template:'<a ng-click="completeFQ()" class="btn btn-primary">{{caption}}</a>',replace:!0,link:function(scope,elm){var prescreenAnswered=0!=Object.keys(prescreen.data.answers).length;scope.caption=prescreenAnswered?"Continue to Full Questionnaire":"Start Questionnaire",scope.completeFQ=function(url){prescreenAnswered?$state.go("screening-start"):$window.location.href="/find-my-benefits"}}}}]),app.directive("selector",[function(){return{link:function(scope,elm){$(elm).click(function(){$(elm).hasClass("checked")?$(elm).removeClass("checked"):$(elm).addClass("checked")})}}}]),app.factory("Months",[function(){return[{id:1,name:"January"},{id:2,name:"February"},{id:3,name:"March"},{id:4,name:"April"},{id:5,name:"May"},{id:6,name:"June"},{id:7,name:"July"},{id:8,name:"August"},{id:9,name:"September"},{id:10,name:"October"},{id:11,name:"November"},{id:12,name:"December"}]}]),app.factory("CronicConditions",[function(){var cronicConditions={},_cronicConditions=[{id:"chroniccondition_no",name:"No Chronic Conditions"},{id:"chroniccondition_1",name:"One Chronic Condition"},{id:"chroniccondition_2_more",name:"Two or More Chronic Conditions"}];return cronicConditions.getCronicConditions=function(){return _cronicConditions},cronicConditions.getByCode=function(code){for(var i=0;i<_cronicConditions.length;i++)if(_cronicConditions[i].id==code)return _cronicConditions[i].name;return""},cronicConditions}]),app.factory("AnswersByCategories",[function(){var retVal={},_retVal={};return retVal.getCategory=function(answerCode){return _retVal[answerCode]},retVal.setCategory=function(answerCode,category,type){_retVal[answerCode]={category:category,type:type}},retVal}]),app.factory("Income",[function(){var income={},_incomes=[{title:"Social Security Retirement and Survivor Benefits",code:"ss_retire",unearned:!0,description:"Income you get from Social Security."},{title:"Social Security Disability",code:"ss_disable",unearned:!0,description:"Social Security Disability Insurance (SSDI) is a cash benefit you and certain members of your family may get if you worked long enough and paid Social Security taxes."},{title:"Supplemental Security Income",code:"ssi",unearned:!0,description:"Supplemental Security Income (SSI) is a cash benefit you may get if you have limited income and resources, and are 65 years of age or older, disabled or blind."},{title:"Pension and Retirement Benefits",code:"pri_retire",unearned:!0,description:"A Pension or Retirement Benefit is a fixed amount of money based on the number of years you worked and how much you earned at jobs you have had."},{title:"Work Income",code:"earned",unearned:!1,description:"Income you get from a job."},{title:"Dividends and Interest",code:"dividends",unearned:!0,description:"Dividends are amounts of money, stock, or other property paid to you by a corporation. Interest income includes money you get from savings you have in banks, credit unions, and other organizations."},{title:"Veteran Benefits",code:"vet_ben",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Cash Assistance",code:"cash_assist",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"TANF",code:"tanf",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Unemployment Insurance",code:"unemployment",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Railroad Retirement Benefits",code:"rr_ben",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Workers Compensation",code:"unemploy",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Other Non Work Income",code:"other_nw",unearned:!0,description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."}];return income.getIncomes=function(){return _incomes},income.isUnearned=function(code){for(var i in _incomes)if(_incomes[i].code==code)return _incomes[i].unearned;return!0},income}]),app.factory("category",["$state",function($state){var _category={};return _category.currentCategory=function(){return void 0==$state.params.category?"prescreen":$state.params.category},_category}]),app.factory("Asset",[function(){var asset={},_assets=[{title:"Cash and Cash Equivalent",code:"cash",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Primary Car",code:"auto1",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Value of Home",code:"home",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Second Car",code:"auto2",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Life Insurance: Face Value",code:"life_face",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Life Insurance: Cash Value",code:"life_cash",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Retirement Accounts",code:"retirement",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Investment Accounts",code:"stocks",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Burial Accounts: Irrevocable",code:"irrevocable",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Burial Accounts: Revocable",code:"revocable",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."},{title:"Other Assets",code:"other_a",description:"Le Lorem Ipsum est simplement du faux texte employé dans la composition et la mise en page avant impression."}];return asset.getAssets=function(){return _assets},asset}]),app.directive("benefitsSlider",["$window","localStorageService",function($window,localStorageService){return{restrict:"A",link:function(scope,elm){function getIndex(currentId){var index;return $navs.each(function(i){$(this).attr("id")==currentId&&(index=i)}),index}function prepNav(){var currentId=$(".benefits-slider-icon.benefits-slider-active").parent().parent().attr("id");return $(".benefits-slider-active").removeClass(activeClass),currentId}function arrowReposition(newNav){$("style[data-benefits-slider]").remove(),$("head").append("<style data-benefits-slider>.benefits-slider-carousel:before,.benefits-slider-carousel:after{ left: "+($(newNav).offset().left-$(".benefits-slider-carousel").offset().left+$(newNav).width()/2)+"px}</style>")}function transitionNav(newIndex){var newNav=$navs.get(newIndex),newCard=$cards.get(newIndex);currentIndex=newIndex,$(newNav).find(".benefits-slider-icon").first().addClass(activeClass),$(newCard).addClass(activeClass),arrowReposition(newNav),$(".benefits-slider-index").text(newIndex+1+" of "+length)}var $navs=$(".benefits-slider-circle-nav>div"),$cards=$(".benefits-slider-carousel>.row"),length=$navs.length,activeClass="benefits-slider-active",currentIndex=0;scope.findBenefits=function(category){localStorageService.set("interested_category",category),$window.location.href="find-my-benefits"},$(".benefits-slider-circle-nav>div").each(function(i){$(this).prop("id","benefits-slider-circle-"+i)}),$(window).resize(function(){arrowReposition($navs.get(currentIndex))}),$(".benefits-slider-index").text("1 of "+length),$(".benefits-slider-arrow.fa-chevron-left").click(function(){var index,currentId,newIndex;currentId=prepNav(),index=getIndex(currentId),newIndex=index-1,newIndex<0&&(newIndex=length-1),transitionNav(newIndex)}),$(".benefits-slider-arrow.fa-chevron-right").click(function(){var index,currentId,newIndex;currentId=prepNav(),index=getIndex(currentId),newIndex=index+1,newIndex>length-1&&(newIndex=0),transitionNav(newIndex)}),$(".benefits-slider-circle-nav>div").click(function(){var newId=$(this).attr("id"),newIndex=getIndex(newId);prepNav(),transitionNav(newIndex)})}}}]),app.directive("breadcrumb",["$document","$state",function($document,$state){return{restrict:"A",templateUrl:"/content/themes/ncoa/resources/views/directives/breadcrumb/breadcrumb.html?"+new Date,link:function(scope,element,attr){scope.pages=["Basics","Health","Household","Finances","Results"],scope.currentState=$state.params.category,scope.hideBreadCrumbs="results"==$state.current.name.split(".")[1]||"initial-results"==$state.current.name.split(".")[1],scope.$on("$stateChangeSuccess",function(){scope.hideBreadCrumbs="results"==$state.current.name.split(".")[1]||"initial-results"==$state.current.name.split(".")[1]})}}}]),app.directive("ncoaCarousel",[function(){return{link:function(scope,elm){$(".currItem").html("1"),$(".currTotal").html($(".ncoa-carousel-container .item").length),$(elm).slick({autoplay:!0,autoplaySpeed:5e3,dots:!1,infinite:!0,speed:1e3,slidesToShow:3,slidesToScroll:3,nextArrow:'<span class="fa fa-chevron-right" aria-hidden="true"></span>',prevArrow:'<span class="fa fa-chevron-left" aria-hidden="true"></span>',responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!1,dots:!1,appendArrows:$(elm)}},{breakpoint:1e3,settings:{slidesToShow:2,slidesToScroll:2,appendArrows:$(".controls")}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1,appendArrows:$(".controls")}}]}),$(elm).on("afterChange",function(event,slick,currentSlide,nextSlide){$(".currItem").html(currentSlide+1)})}}}]),app.directive("grid",["$state","AnswersByCategories",function($state,AnswersByCategories){return{restrict:"E",scope:{title:"@",description:"@",code:"@",type:"@",request:"@",answer_field:"=answerField"},templateUrl:"/content/themes/ncoa/resources/views/directives/grid/grid-tpl.html?"+new Date,link:function(scope,element,attr){scope.category=$state.params.category;var cat=AnswersByCategories.getCategory("marital_stat");switch(scope.isMarital=!1,void 0!=cat&&void 0!=scope.$root.answers[cat.category]&&void 0!=scope.$root.answers[cat.category].marital_stat&&("married"!=scope.$root.answers[cat.category].marital_stat.code&&"widowed"!=scope.$root.answers[cat.category].marital_stat.code||(scope.isMarital=!0)),parseInt(scope.type)){case 1:scope.self_code="s_income_",scope.spouse_code="sp_income_",scope.joint_code="s_sp_income_",scope.household_code="hh_income_";break;case 2:scope.self_code="s_asset_",scope.spouse_code="sp_asset_",scope.joint_code="s_sp_asset_",scope.household_code="hh_asset_";break;default:scope.self_code="",scope.spouse_code="",scope.joint_code="",scope.household_code=""}scope.calcTotal=function(code){var suffix="hh_income_"==code||"hh_asset_"==code?"_simple":"";void 0==scope.$root.answers[scope.category]&&(scope.$root.answers[scope.category]={}),scope.$root.answers[scope.category][code+"total_complete"+suffix]=0,scope.$root.answers[scope.category][code+"total_unearned"+suffix]=0;for(var i in scope.$root["grid_"+code+"_"+scope.type])void 0!=scope.$root.answers[scope.category][code+i+suffix]&&(scope.$root.answers[scope.category][code+"total_complete"+suffix]=scope.$root.answers[scope.category][code+"total_complete"+suffix]+scope.$root.answers[scope.category][code+i+suffix],0==scope.$root["grid_"+code+"_"+scope.type][i]&&(scope.$root.answers[scope.category][code+"total_unearned"+suffix]=scope.$root.answers[scope.category][code+"total_unearned"+suffix]+scope.$root.answers[scope.category][code+i+suffix]));scope.$root.answers[scope.category][code+"total_earned"+suffix]=scope.$root.answers[scope.category][code+"total_complete"+suffix]-scope.$root.answers[scope.category][code+"total_unearned"+suffix];var total_self=void 0==scope.$root.answers[scope.category][scope.self_code+"total_complete"]?0:scope.$root.answers[scope.category][scope.self_code+"total_complete"]+0,total_spouse=void 0==scope.$root.answers[scope.category][scope.spouse_code+"total_complete"]?0:scope.$root.answers[scope.category][scope.spouse_code+"total_complete"]+0,total_joint=void 0==scope.$root.answers[scope.category][scope.joint_code+"total_complete"]?0:scope.$root.answers[scope.category][scope.joint_code+"total_complete"]+0,total_hh=void 0==scope.$root.answers[scope.category][scope.household_code+"total_complete_simple"]?0:scope.$root.answers[scope.category][scope.household_code+"total_complete_simple"]+0;scope.$root.answers[scope.category][scope.household_code+"total_complete"]=total_self+total_spouse+total_joint+total_hh,total_self=void 0==scope.$root.answers[scope.category][scope.self_code+"total_unearned"]?0:scope.$root.answers[scope.category][scope.self_code+"total_unearned"]+0,total_spouse=void 0==scope.$root.answers[scope.category][scope.spouse_code+"total_unearned"]?0:scope.$root.answers[scope.category][scope.spouse_code+"total_unearned"]+0,total_joint=void 0==scope.$root.answers[scope.category][scope.joint_code+"total_unearned"]?0:scope.$root.answers[scope.category][scope.joint_code+"total_unearned"]+0,total_hh=void 0==scope.$root.answers[scope.category][scope.household_code+"total_unearned_simple"]?0:scope.$root.answers[scope.category][scope.household_code+"total_unearned_simple"]+0,scope.$root.answers[scope.category][scope.household_code+"total_unearned"]=total_self+total_spouse+total_joint+total_hh,scope.$root.answers[scope.category][scope.household_code+"total_earned"]=scope.$root.answers[scope.category][scope.household_code+"total_complete"]-scope.$root.answers[scope.category][scope.household_code+"total_unearned"]},scope.$watch("$root.answers."+scope.category+"."+scope.self_code+scope.answer_field.code,function(){void 0==scope.$root["grid_"+scope.self_code+"_"+scope.type]&&(scope.$root["grid_"+scope.self_code+"_"+scope.type]={}),scope.$root["grid_"+scope.self_code+"_"+scope.type][scope.answer_field.code]=scope.answer_field.earned,scope.calcTotal(scope.self_code)}),scope.$watch("$root.answers."+scope.category+"."+scope.spouse_code+scope.answer_field.code,function(){void 0==scope.$root["grid_"+scope.spouse_code+"_"+scope.type]&&(scope.$root["grid_"+scope.spouse_code+"_"+scope.type]={}),scope.$root["grid_"+scope.spouse_code+"_"+scope.type][scope.answer_field.code]=scope.answer_field.earned,scope.calcTotal(scope.spouse_code)}),scope.$watch("$root.answers."+scope.category+"."+scope.joint_code+scope.answer_field.code,function(){void 0==scope.$root["grid_"+scope.joint_code+"_"+scope.type]&&(scope.$root["grid_"+scope.joint_code+"_"+scope.type]={}),scope.$root["grid_"+scope.joint_code+"_"+scope.type][scope.answer_field.code]=scope.answer_field.earned,scope.calcTotal(scope.joint_code)}),scope.$watch("$root.answers."+scope.category+"."+scope.household_code+scope.answer_field.code+"_simple",function(){void 0==scope.$root["grid_"+scope.household_code+"_"+scope.type]&&(scope.$root["grid_"+scope.household_code+"_"+scope.type]={}),scope.$root["grid_"+scope.household_code+"_"+scope.type][scope.answer_field.code]=scope.answer_field.earned,scope.calcTotal(scope.household_code)}),scope.$root.answers[scope.category][scope.self_code+scope.code]=0,scope.$root.answers[scope.category][scope.spouse_code+scope.code]=0,scope.$root.answers[scope.category][scope.joint_code+scope.code]=0,scope.$root.answers[scope.category][scope.household_code+scope.code+"_simple"]=0}}}]),app.directive("ncoaLoader",function(){return{restrict:"E",templateUrl:"/content/themes/ncoa/resources/views/directives/loader/loader.html?"+new Date,link:function(scope,element,attrs){}}}),app.directive("medicationSelector",["Drugs","$state",function(Drugs,$state){return{restrict:"E",scope:{answer_field:"=answerField"},templateUrl:"/content/themes/ncoa/resources/views/directives/med-selector/medication-selector.html?"+new Date,link:function(scope,elm){Drugs.setDrugs(scope.answer_field.options),scope.category=$state.params.category;for(var drugs=Drugs.getDrugs(),i=0;i<drugs.length;i++){$("<option/>",{value:drugs[i].code,text:drugs[i].display}).appendTo($("#multiselect"))}$("#multiselect").multiSelect({selectableHeader:"<p class='bold'>Available Medications</p><input type='text' class='form-control' autocomplete='off' placeholder='Search...'>",selectionHeader:"<p class='bold'>My Medication List</p>",selectableFooter:"<button class='btn btn-secondary add' disabled>Add to My List</button>",selectionFooter:"<button class='btn btn-secondary remove' disabled>Remove from My List</button>",afterInit:function(ms){var that=this,$selectableSearch=that.$selectableUl.prev(),selectableSearchString="#"+that.$container.attr("id")+" .ms-elem-selectable:not(.ms-selected)";that.qs1=$selectableSearch.quicksearch(selectableSearchString).on("keydown",function(e){if(40===e.which)return that.$selectableUl.focus(),!1})},afterSelect:function(){this.qs1.cache(),$(".ms-selectable .ms-list .selected").removeClass("selected"),$(".ms-selectable .add").attr("disabled",!0)},afterDeselect:function(values){this.qs1.cache(),$(".ms-selectable .ms-list .selected").removeClass("selected"),$(".ms-selection .remove").attr("disabled",!0)}}),$(".ms-selectable").on("click","button.add",function(){var selected=$(".ms-selectable .ms-list .selected span").map(function(){return Drugs.codeByName($(this).html())}).get();$("#multiselect").multiSelect("select",selected);for(var i=0;i<selected.length;i++)scope.$root.answers[scope.category][selected[i]]="y"}),$(".ms-selection").on("click","button.remove",function(){var selected=$(".ms-selection .ms-list .selected span").map(function(){return Drugs.codeByName($(this).html())}).get();$("#multiselect").multiSelect("deselect",selected);for(var i=0;i<selected.length;i++)delete scope.$root.answers[scope.category][selected[i]]})}}}]),app.directive("ncoaFooter",["$http",function($http){return{restrict:"E",scope:{url:"@"},link:function(scope,elm){$http.get(scope.url).then(function(response){console.log(response.data)}),$.ajax({url:scope.url,context:document.body}).success(function(data){console.log(data)})}}}]),app.directive("ncoaForm",[function(){return{restrict:"A",link:function(scope,elm){scope.category=window.category,scope.state=window.state,scope.error=!1,scope.processForm=function(form,event){""==scope.category&&""==scope.state&&(scope.error=!0,event.preventDefault())}}}}]),app.directive("ncoaPrograms",[function(){return{restrict:"A",link:function(scope,elm){scope.programs=window.programs,scope.currentProgramsList=scope.programs.slice(0,10),scope.pageCount=Math.ceil(scope.programs.length/10),scope.currentPage=0==scope.pageCount?0:1,scope.showPage=function(pageNum){return pageNum<1?scope.currentPage=0==scope.pageCount?0:1:pageNum>Math.ceil(scope.programs.length/10)?scope.currentPage=Math.ceil(scope.programs.length/10):scope.currentPage=pageNum,scope.currentProgramsList=scope.programs.slice(10*(scope.currentPage-1),10*scope.currentPage),!1}}}}]),app.directive("pageSwitch",["$rootScope","$state","prescreen","screening","saveScreening","ScreeningRoutes",function($rootScope,$state,prescreen,screening,saveScreening,ScreeningRoutes){return{link:function(scope,elm){"questionnaire.results"==$state.current.name&&(scope.isResults=!0),void 0==$state.params.category?(scope.prev="prescreen",scope.next="screening-start"):"questionnaire.results"==$state.current.name?(scope.prev="finances",scope.next="basics"):(scope.prev=ScreeningRoutes[$state.params.category].prev,scope.next=ScreeningRoutes[$state.params.category].next),scope.switchPage=function(stateName){if("prescreen"==stateName||"screening-start"==stateName||"questionnaire.initial-results"==stateName)$state.transitionTo(stateName);else{var request={};void 0!=screening.data.results.screening.id&&(request.screening=screening.data.results.screening),request.pgno=ScreeningRoutes[$state.params.category].pgno,void 0!=prescreen.data.results.screening.id&&(request.prescreen=prescreen.data.results.screening),"questionnaire.loader"==stateName&&(request.lastSet="true",$rootScope.showLoader=!0,document.querySelector(".container").scrollIntoView()),request.answers=void 0==scope.$root.answers[$state.params.category]?{}:scope.$root.answers[$state.params.category],saveScreening.post(request).success(function(data,status,headers,config){if("questionnaire.loader"==stateName){screening.data.answers=scope.$root.answers,screening.data.results.screening=data.screening,screening.data.results.found_programs=data.found_programs,screening.data.results.key_programs=[];for(var i=0;i<screening.data.results.found_programs.length;i++)for(var j=0;j<screening.data.results.found_programs[i].programs.length;j++)if(screening.data.results.found_programs[i].programs[j].key_program){var program=screening.data.results.found_programs[i].programs[j];program.category=screening.data.results.found_programs[i].category,screening.data.results.key_programs.push(program)}screening.save(),$state.transitionTo("questionnaire.results")}else{screening.data.results.screening=data,screening.data.answers=scope.$root.answers,screening.save();var stateId=void 0==$state.params.state?scope.$root.prescreen.stateId:$state.params.state;$state.transitionTo("screening",{category:stateName,state:stateId})}})}}}}}]),app.directive("profile",["prescreen","screening","$state","Drugs","CronicConditions",function(prescreen,screening,$state,Drugs,CronicConditions){return{restrict:"A",templateUrl:"/content/themes/ncoa/resources/views/directives/profile/profile.html?"+new Date,link:function(scope,element,attr){if(scope.screenData=prescreen.data.screenData,scope.showOptions=!1,scope.programs_calculated=!1,void 0!=screening.data.results.found_programs&&(scope.programs_calculated=screening.data.results.found_programs.length>0),scope.slugs={},scope.printReport=function(){if(Object.keys(scope.slugs).length>0){var i=0,firstSlug="",slugs="";for(var key in scope.slugs)0==i?firstSlug=key:slugs=slugs+";"+key,i++;slugs=slugs.substring(1),window.open("/fact-sheets/factsheet_"+firstSlug+"/?state="+prescreen.data.answers.stateId+"&zipcode="+prescreen.data.answers.zipcode+"&slugs="+slugs+"&pdf=y")}},scope.found_programs=[],scope.programs_calculated){scope.programs_calculated=!0;for(var i=0;i<screening.data.results.found_programs.length;i++)for(var j=0;j<screening.data.results.found_programs[i].programs.length;j++)scope.found_programs.push(screening.data.results.found_programs[i].programs[j])}scope.cronicConditions=function(){try{return CronicConditions.getByCode(void 0==scope.questionnaire.request.health.chronic_condition?"":scope.questionnaire.request.health.chronic_condition)}catch(e){return""}},scope.drugs=function(){var retVal="";try{for(var i=0;i<scope.questionnaire.request.health.drugs.length;i++)retVal=retVal+Drugs.nameByCode(scope.questionnaire.request.health.drugs[i])+", "}catch(e){retVal=""}return retVal.substr(0,retVal.length-2)},scope.categories=function(){for(var retVal="",i=0;i<scope.screenData.benefits_categories.length;i++)retVal=retVal+scope.screenData.benefits_categories[i]+", ";return retVal.substr(0,retVal.length-2)}}}}]),app.directive("slideDown",[function(){return{link:function(scope,elm){$(elm).children(".program-header").click(function(){$(elm).find(".programs-container").slideToggle(),$(elm).toggleClass("active")})}}}]),app.factory("questionTemplates",[function(){var directivePath="/content/themes/ncoa/resources/views/directives/question/";return{zip:directivePath+"zip.html",client:directivePath+"client.html",veteran:directivePath+"veteran.html",dob:directivePath+"dob.html",marital_stat:directivePath+"marital_stat.html",bcuqc_income:directivePath+"bcuqc_income.html",bcuqc_interest_category:directivePath+"bcuqc_interest_category.html",citizen:directivePath+"citizen.html",sp_veteran:directivePath+"sp_veteran.html",incomegrid:directivePath+"incomegrid.html",assetgrid:directivePath+"assetgrid.html"}}]),app.directive("question",["questionTemplates","AnswersByCategories","category","localStorageService","BenefitItems",function(questionTemplates,AnswersByCategories,category,localStorageService,BenefitItems){return{restrict:"E",template:"<span ng-show='checkRule()' ng-include='question_template_link'></span>",link:function(scope,element,ngShow){for(var i=0;i<scope.question.answer_fields.length;i++)void 0!=scope.question.answer_fields[i].default&&void 0==scope.$root.answers[category.currentCategory()][scope.question.answer_fields[i].code]&&(scope.$root.answers[category.currentCategory()][scope.question.answer_fields[i].code]=scope.question.answer_fields[i].default),AnswersByCategories.setCategory(scope.question.answer_fields[i].code,category.currentCategory(),scope.question.answer_fields[i].type);void 0==scope.question.rule?scope.checkRule=function(){return!0}:""==scope.question.rule?scope.checkRule=function(){return!0}:0!=scope.question.rulecode.indexOf("question_dep_")?scope.checkRule=function(){return!0}:scope.checkRule=function(){if(void 0==scope.question.rule)return!0;if(""==scope.question.rule)return!0;for(var ruleArray=scope.question.rule.split("#"),evalString="",i=0;i<ruleArray.length;i++){var isVar=i%2==1;if(isVar){var val="";try{var ans=ruleArray[i].trim(),cat=AnswersByCategories.getCategory(ans);switch(cat.type){case"select":val="'"+scope.$root.answers[cat.category][ans].code+"'";break;case"yn":val="'"+scope.$root.answers[cat.category][ans]+"'";break;default:val=scope.$root.answers[cat.category][ans]}}catch(err){val="undefined"}evalString+=val}else evalString+=ruleArray[i]}var retVal=!1;try{retVal=eval(evalString)}catch(err){retVal=!1}return retVal},scope.category=category.currentCategory(),
void 0==questionTemplates[scope.question.code]?scope.question_template_link="/content/themes/ncoa/resources/views/directives/question/question.html?"+new Date:(void 0!=localStorageService.get("interested_category")&&"bcuqc_interest_category"==scope.question.code&&("and_more"==localStorageService.get("interested_category")?(scope.addProgram(BenefitItems.getByCode("bcuqc_category_transportation")),scope.addProgram(BenefitItems.getByCode("bcuqc_category_education")),scope.addProgram(BenefitItems.getByCode("bcuqc_category_discounts")),scope.addProgram(BenefitItems.getByCode("bcuqc_category_other_assistance"))):scope.addProgram(BenefitItems.getByCode(localStorageService.get("interested_category"))),localStorageService.remove("interested_category")),scope.question_template_link=questionTemplates[scope.question.code]+"?"+new Date)},scope:{question:"="},controller:"questionController"}}]),app.directive("setDefaultAnswer",[function(){return{link:function(scope,element,attr){void 0==scope.$root.answers[scope.category]&&(scope.$root.answers[scope.category]={}),scope.$root.answers[scope.category][scope.code]=scope.value},scope:{category:"@",code:"@",value:"@"}}}]),app.directive("answerfield",["$state",function($state){return{template:"<span ng-include='answer_field_link'></span>",link:function(scope,element,attributes,ngModel,ngShow){scope.answer_field_link="/content/themes/ncoa/resources/views/directives/answer-field/"+scope.answer_field.type+".html?"+new Date,scope.category=$state.params.category},scope:{answer_field:"=answerField",question:"=question"}}}]),app.directive("ngLabel",["$compile",function($compile){return{restrict:"E",link:function(scope,element,attr){element.html(scope.text)},scope:{text:"@"}}}]),app.directive("script",["localStorageService",function(localStorageService){return{restrict:"E",scope:!1,link:function(scope,elem,attr){if("text/javascript-lazy"===attr.type){var code=elem.text();new Function(code)()}}}}]),app.directive("textSizeChanger",["$document","localStorageService",function($document,localStorageService){return{restrict:"E",templateUrl:"/content/themes/ncoa/resources/views/directives/text-size-changer/text-size-changer.html?"+new Date,scope:{min:"@",mid:"@",max:"@",unit:"@"},link:function(scope,element,attr){function sizeChanger(size){switch($document[0].body.style.fontSize=size+scope.unit,$(element).addClass(size),size){case"18":scope.sel="min";break;case"20":scope.sel="mid";break;default:scope.sel="max"}localStorageService.set("TextSize",size)}var tSize=localStorageService.get("TextSize");scope.sel="min",tSize&&sizeChanger(tSize),scope.changeSize=sizeChanger}}}]),app.directive("yearDrop",["category",function(category){function getYears(offset,range){for(var currentYear=(new Date).getFullYear(),years=[],i=0;i<range;i++)years.push(currentYear-i);return years}return{restrict:"E",template:'<select class="form-control inline" name="dob-year" ng-model="$root.answers[category][code]" ng-options="y for y in years"></select>',link:function(scope,element,attrs){scope.years=getYears(+attrs.offset,+attrs.range),scope.category=category.currentCategory(),void 0==scope.$root.answers[category.currentCategory()][scope.code]&&(scope.$root.answers[category.currentCategory()][scope.code]=scope.years[66])},scope:{code:"@"}}}]),app.directive("stateSelection",function(){return{restrict:"A",link:function(scope,element,attrs){scope.stateChange=function(){"TX"==scope.mapState?$("#map_base svg path#map_43").css({fill:"#1F3D7D"}):$("#map_base svg path#map_43").css({fill:"#1888de"}),"AL"==scope.mapState?$("#map_base svg path#map_1").css({fill:"#1F3D7D"}):$("#map_base svg path#map_1").css({fill:"#1888de"})}}}}),app.directive("zipcode",["locationFinder","category","$filter","localStorageService",function(locationFinder,category,$filter,localStorageService){return{link:function(scope,elm){function validateZip(data){if(5!=scope.$root.answers[category.currentCategory()].zip.length)return scope.$root.isZipValid=!1,scope.zipValid="",scope.$parent.zipCodeCheckResult="Error!",scope.$parent.zipCodeDescription="Please enter a valid zip code in the United States.",void(scope.$parent.zipCodeUpdated=!0);if("OK"==data.status){for(var isZipInvalid=!0,i=0;i<data.results[0].address_components.length;i++)for(var j=0;j<data.results[0].address_components[i].types.length;j++)"country"!=data.results[0].address_components[i].types[j]&&"political"!=data.results[0].address_components[i].types[j]||"US"!=data.results[0].address_components[i].short_name||(isZipInvalid=!1),"postal_code"==data.results[0].address_components[i].types[j]&&(scope.$root.answers[category.currentCategory()].zipcode=data.results[0].address_components[i].long_name),"administrative_area_level_1"==data.results[0].address_components[i].types[j]&&(scope.$root.answers[category.currentCategory()].stateId=data.results[0].address_components[i].short_name,scope.zipCodeLabel="Update Zip Code"),"administrative_area_level_2"==data.results[0].address_components[i].types[j]&&(scope.$root.answers[category.currentCategory()].county=data.results[0].address_components[i].short_name.toUpperCase().replace(" COUNTY",""));isZipInvalid?(scope.$root.isZipValid=!1,scope.zipValid="",scope.$parent.zipCodeCheckResult="Error!",scope.$parent.zipCodeDescription="Please enter a valid zip code in the United States."):(scope.$root.answers[category.currentCategory()].zipcode_formatted=$filter("limitTo")(data.results[0].formatted_address,data.results[0].formatted_address.lastIndexOf(","),0),scope.$root.isZipValid=!0,scope.zipValid="1",scope.$parent.zipCodeCheckResult="Success!",scope.$parent.zipCodeDescription=scope.$root.answers[category.currentCategory()].zipcode_formatted)}else scope.$root.isZipValid=!1,scope.zipValid="",scope.$parent.zipCodeCheckResult="Error!",scope.$parent.zipCodeDescription="Please enter a valid zip code in the United States.";scope.$parent.zipCodeUpdated=!0}scope.category=category.currentCategory(),scope.regPattern="\\d{5}",scope.$root.isZipValid=!1,scope.zipValid="",scope.$root.isZipCodeValidating=!1,scope.updateZip=function(){scope.$root.isZipCodeValidating=!0,locationFinder.getLocation(scope.$root.answers[scope.category].zip).success(function(data,status,headers,config){validateZip(data),scope.$root.isZipCodeValidating=!1})},void 0!=localStorageService.get("v_zipcode")?(scope.zipCodeLabel="Update Zip Code",scope.$root.answers[category.currentCategory()].zip=localStorageService.get("v_zipcode"),localStorageService.remove("v_zipcode"),scope.updateZip()):scope.zipCodeLabel="Find Zip Code",scope.resetZip=function(){scope.$root.isZipEdit=!0,$("#zipcode").focus()},void 0!=scope.$root.answers&&void 0!=scope.$root.answers[category.currentCategory()]&&void 0!=scope.$root.answers[category.currentCategory()].zipcode&&scope.updateZip()}}}]),app.factory("BenefitItems",[function(){var BenefitItems={},_BenefitItems=[{name:"Medication",code:"bcuqc_category_rx",image:"/content/themes/ncoa/resources/assets/images/categories/category_medicine.svg",alt:"Medicine Pills",title:"Medicine Pills",sort:1},{name:"Health Care",code:"bcuqc_category_medicaid",image:"/content/themes/ncoa/resources/assets/images/categories/category_health.svg",alt:"Doctor Symbols",title:"Doctor Symbol",sort:2},{name:"Income Assistance",code:"bcuqc_category_income",image:"/content/themes/ncoa/resources/assets/images/categories/category_income.svg",alt:"Money",title:"Money",sort:3},{name:"Food & Nutrition",code:"bcuqc_category_nutrition",image:"/content/themes/ncoa/resources/assets/images/categories/category_food.svg",alt:"Basket of Food",title:"Basket of Food",sort:4},{name:"Housing & Utilities",code:"bcuqc_category_utility",image:"/content/themes/ncoa/resources/assets/images/categories/category_housing.svg",alt:"House",title:"House",sort:5},{name:"Tax Relief",code:"bcuqc_category_property_taxrelief",image:"/content/themes/ncoa/resources/assets/images/categories/category_taxRelief.svg",alt:"Piggy Bank",title:"Piggy Bank",sort:6},{name:"Veterans",code:"bcuqc_category_veteran",image:"/content/themes/ncoa/resources/assets/images/categories/category_veteran.svg",alt:"Medal",title:"Medal",sort:7},{name:"Employment",code:"bcuqc_category_employment",image:"/content/themes/ncoa/resources/assets/images/categories/category_employment.svg",alt:"Briefcase",title:"Briefcase",sort:8},{name:"Transportation",code:"bcuqc_category_transportation",image:"/content/themes/ncoa/resources/assets/images/categories/category_transportation.svg",alt:"Automobile",title:"Automobile",sort:9},{name:"Education",code:"bcuqc_category_education",image:"/content/themes/ncoa/resources/assets/images/categories/category_education.svg",alt:"Apple on Book",title:"Apple on Book",sort:10},{name:"Discount",code:"bcuqc_category_discounts",image:"/content/themes/ncoa/resources/assets/images/categories/category_discounts.svg",alt:"Percent Off",title:"Percent Off",sort:11},{name:"Other Assistance",code:"bcuqc_category_other_assistance",image:"/content/themes/ncoa/resources/assets/images/categories/category_assistance.svg",alt:"Information",title:"Information",sort:12}];return BenefitItems.returnAllCodes=function(){var codes=[];return _BenefitItems.forEach(function(element){codes.push(element.code)}),codes},BenefitItems.getBenefitItems=function(){return _BenefitItems},BenefitItems.getByCode=function(code){for(var i=0;i<_BenefitItems.length;i++)if(_BenefitItems[i].code==code)return _BenefitItems[i]},BenefitItems.programsInStructure=function(struct){var retVal=0;for(var i in struct)void 0!=BenefitItems.getByCode(i)&&retVal++;return retVal},BenefitItems}]),app.factory("ScreeningRoutes",[function(){var _routes={};return _routes.basics={prev:"questionnaire.initial-results",next:"health",pgno:1},_routes.health={prev:"basics",next:"household",pgno:2},_routes.household={prev:"health",next:"finances",pgno:3},_routes.finances={prev:"household",next:"questionnaire.loader",pgno:4},_routes}]),app.factory("Drugs",[function(){var Drugs={},_drugs=[];return Drugs.setDrugs=function(drugs){_drugs=drugs},Drugs.getDrugs=function(){return _drugs},Drugs.nameByCode=function(code){for(var i=0;i<_drugs.length;i++)if(_drugs[i].code==code)return _drugs[i].display},Drugs.codeByName=function(name){for(var i=0;i<_drugs.length;i++)if(_drugs[i].display==name)return _drugs[i].code},Drugs}]),app.service("locationFinder",["$http",function($http){this.getLocation=function(zipcode){return $http.get("//maps.googleapis.com/maps/api/geocode/json?address="+zipcode+"&sensor=true")}}]),app.service("savePrescreen",["$http",function($http){this.post=function(data){return $http.post(window.webServiceUrl+"/rest/backend/screening/savePrescreen",data,{headers:{"Content-Type":"text/plain; charset=UTF-8"}})}}]),app.service("saveScreening",["$http",function($http){this.post=function(data){return $http.post(window.webServiceUrl+"/rest/backend/screening/saveScreening",data,{headers:{"Content-Type":"text/plain; charset=UTF-8"}})}}]),app.service("prescreenQuestions",["$http",function($http){this.get=function(){return $http.get(window.webServiceUrl+"/rest/backend/questionnaire/prescreen")}}]),app.service("screeningQuestions",["$http",function($http){this.get=function(category,prescreen,state){return $http.get(window.webServiceUrl+"/rest/backend/questionnaire/"+category+"/"+prescreen+"/"+state)}}]),app.factory("prescreen",["localStorageService","$window",function(localStorageService,$window){var prescreenform={},_data=localStorageService.get("prescreen");return prescreenform.clear=function(){localStorageService.remove("prescreen")},void 0==_data?prescreenform.data={}:_data.name==$window.name?prescreenform.data=_data:(localStorageService.remove("prescreen"),prescreenform.data={}),void 0==prescreenform.data.answers&&(prescreenform.data.answers={}),prescreenform.save=function(){prescreenform.data.name=$window.name,localStorageService.set("prescreen",prescreenform.data)},prescreenform}]),app.factory("screening",["localStorageService","$window","ScreeningRoutes",function(localStorageService,$window,ScreeningRoutes){var screening={},_data=localStorageService.get("screening");if(void 0!=_data&&_data.name!=$window.name&&localStorageService.remove("screening"),void 0==_data?(_data={},_data.questions={},_data.answers={},_data.results={},_data.results.screening={}):void 0==_data.answers&&(_data.answers={}),Object.keys(_data.answers).length!=Object.keys(ScreeningRoutes).length){_data.answers={};for(i in ScreeningRoutes)_data.answers[i]={}}return screening.data=_data,screening.save=function(){localStorageService.set("screening",screening.data)},screening.clear=function(){localStorageService.remove("screening")},screening}]),app.factory("questionnaire",["Income","Asset",function(Income,Asset){var questionnaire={};return questionnaire.incomes=Income.getIncomes(),questionnaire.assets=Asset.getAssets(),questionnaire}]),app.controller("questionController",["$scope","category","BenefitItems","AnswersByCategories","Months",function($scope,category,BenefitItems,AnswersByCategories,Months){$scope.category=category.currentCategory(),$scope.months=Months,$scope.programs=BenefitItems.getBenefitItems(),$scope.selectLinkText="Select All",$scope.showSpouseVeteranStatus=function(){return void 0!=$scope.$root.answers[category.currentCategory()].marital_stat&&(("married"==$scope.$root.answers[category.currentCategory()].marital_stat.code||"married_living_sep"==$scope.$root.answers[category.currentCategory()].marital_stat.code||"widowed"==$scope.$root.answers[category.currentCategory()].marital_stat.code)&&"n"==$scope.$root.answers[category.currentCategory()].veteran)},$scope.showBenefits=function(){return void 0!=$scope.$root.answers[category.currentCategory()].veteran&&void 0!=$scope.$root.answers[category.currentCategory()].marital_stat},$scope.addProgram=function(program){void 0==$scope.$root.answers[category.currentCategory()][program.code]?$scope.$root.answers[category.currentCategory()][program.code]="y":delete $scope.$root.$root.answers[category.currentCategory()][program.code],$scope.$root.areProgramsAdded=0==BenefitItems.programsInStructure($scope.$root.answers[category.currentCategory()])?void 0:"1",BenefitItems.programsInStructure($scope.$root.answers[category.currentCategory()])==$scope.programs.length?$scope.selectLinkText="Deselect All":$scope.selectLinkText="Select All"},$scope.programAdded=function(programCode){return void 0!=$scope.$root.$root.answers[category.currentCategory()][programCode]},$scope.selectAll=function(){if(BenefitItems.programsInStructure($scope.$root.answers[category.currentCategory()])==$scope.programs.length){for(var i=0;i<$scope.programs.length;i++)delete $scope.$root.$root.answers[category.currentCategory()][$scope.programs[i].code];$(".benefits-selector-repeater").removeClass("checked"),$scope.selectLinkText="Select All"}else{for(var i=0;i<$scope.programs.length;i++)$scope.$root.answers[category.currentCategory()][$scope.programs[i].code]="y";$(".benefits-selector-repeater").addClass("checked"),$scope.selectLinkText="Deselect All"}$scope.$root.areProgramsAdded=0==BenefitItems.programsInStructure($scope.$root.answers[category.currentCategory()])?void 0:"1"}}]),app.controller("preScreenController",["$scope","localStorageService","prescreen","locationFinder","savePrescreen","$timeout","$state","BenefitItems","prescreenQuestions","screening",function($scope,localStorageService,prescreen,locationFinder,savePrescreen,$timeout,$state,BenefitItems,prescreenQuestions,screening){$scope.category="prescreen",$scope.showLoader=!1,void 0==$scope.$root.answers&&($scope.$root.answers={}),$scope.$root.answers.prescreen=prescreen.data.answers,$scope.sibmitDisabled=!0,void 0==$scope.$root.prescreen&&($scope.$root.prescreen={},$scope.$root.prescreen.programList={}),$scope.canContinue=!0,$scope.showquestions=!1,$scope.$root.prescreen.showCTA=!0,$scope.$root.areProgramsAdded=0==BenefitItems.programsInStructure($scope.$root.answers.prescreen)?void 0:"1",prescreenQuestions.get().success(function(data,status,headers,config){prescreen.data.questions=data,$scope.questionSet=prescreen.data.questions}),$scope.submitPrescreen=function(){$scope.showLoader=!0,document.querySelector(".container").scrollIntoView(),$scope.sibmitDisabled=!0,prescreen.data.screenData={},prescreen.data.screenData.formatted_address=$scope.$root.answers[$scope.category].zipcode_formatted,prescreen.data.screenData.searchingFor=$scope.$root.answers[$scope.category].client.display,prescreen.data.screenData.date_of_birth={month:$scope.$root.answers[$scope.category].dob_month.name,year:$scope.$root.answers[$scope.category].dob_year},prescreen.data.screenData.marital_status=$scope.$root.answers[$scope.category].marital_stat.display,prescreen.data.screenData.veteran="y"==$scope.$root.answers[$scope.category].veteran?"Yes":"No",prescreen.data.screenData.benefits_categories=[],prescreen.data.screenData.benefits_categories_codes=[];for(var programCatCode in $scope.$root.answers[$scope.category])void 0!=BenefitItems.getByCode(programCatCode)&&(prescreen.data.screenData.benefits_categories.push(BenefitItems.getByCode(programCatCode)),prescreen.data.screenData.benefits_categories_codes.push(programCatCode));console.log(prescreen.data.screenData);var request=$scope.$root.answers[$scope.category];request.state_id=$scope.$root.answers[$scope.category].stateId,request.st=$scope.$root.answers[$scope.category].stateId,savePrescreen.post(request).success(function(data,status,headers,config){$scope.sibmitDisabled=!1,prescreen.data.answers=$scope.$root.answers[$scope.category],prescreen.data.results=data,prescreen.save(),screening.data.results.screening.id=void 0,$scope.showLoader=!1,$state.go("questionnaire.initial-results")})},$scope.$watch("$root.answers."+$scope.category+".client",function(){void 0==$scope.$root.answers[$scope.category].client||$(".dob").is(":visible")||setTimeout(function(){var test=document.querySelector(".dob");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)}),$scope.$watch("$root.answers."+$scope.category+".dob_year",function(){void 0==$scope.$root.answers[$scope.category].dob_month||$(".income").is(":visible")||setTimeout(function(){var test=document.querySelector(".income");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)}),$scope.$watch("$root.answers."+$scope.category+".dob_month",function(){void 0==$scope.$root.answers[$scope.category].dob_year||$(".income").is(":visible")||setTimeout(function(){var test=document.querySelector(".income");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)}),$scope.$watch("$root.answers."+$scope.category+".bcuqc_income",function(){void 0==$scope.$root.answers[$scope.category].bcuqc_income||$(".marital-status").is(":visible")||setTimeout(function(){var test=document.querySelector(".marital-status");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)}),$scope.$watch("$root.answers."+$scope.category+".marital_stat",function(){void 0==$scope.$root.answers[$scope.category].marital_stat||$(".veteran-status").is(":visible")||setTimeout(function(){var test=document.querySelector(".veteran-status");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)}),$scope.$watch("$root.answers."+$scope.category+".veteran",function(){var marital_stat=$scope.$root.answers[$scope.category].marital_stat,veteran=$scope.$root.answers[$scope.category].veteran;void 0!=marital_stat&&("married"!=marital_stat.code&&"married_living_sep"!=marital_stat.code&&"widowed"!=marital_stat.code||"n"!=veteran||$(".partner-veteran-status").is(":visible")?"married"!=marital_stat.code&&"married_living_sep"!=marital_stat.code&&"widowed"!=marital_stat.code||"y"!=veteran||$(".benefits").is(":visible")?"married"!=marital_stat.code&&"married_living_sep"!=marital_stat.code&&"widowed"!=marital_stat.code||"n"!=veteran||$(".benefits").is(":visible")?"divorced"!=marital_stat.code&&"single"!=marital_stat.code||"y"!=veteran||$(".benefits").is(":visible")?"divorced"!=marital_stat.code&&"single"!=marital_stat.code||"n"!=veteran||$(".benefits").is(":visible")||($scope.sibmitDisabled=!1,setTimeout(function(){var test=document.querySelector(".benefits");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)):($scope.sibmitDisabled=!1,setTimeout(function(){var test=document.querySelector(".veteran-status .cta");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-10+"px"},500)},500)):($scope.sibmitDisabled=!1,setTimeout(function(){var test=document.querySelector(".benefits");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500)):($scope.sibmitDisabled=!1,setTimeout(function(){var test=document.querySelector(".veteran-status .cta");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-10+"px"},500)},500)):setTimeout(function(){var test=document.querySelector(".partner-veteran-status");void 0!=test&&$("html,body").animate({scrollTop:$(test).offset().top-100+"px"},500)},500))}),$scope.disableSubmit=function(){return void 0==this.prescreenForm||!this.prescreenForm.$valid}}]),app.controller("preScreenInitalController",["$scope","$state","prescreenQuestions","prescreen",function($scope,$state,prescreenQuestions,prescreen){void 0==$scope.$root.answers&&($scope.$root.answers={}),$scope.$root.answers.prescreen=prescreen.data.answers,prescreenQuestions.get().success(function(data,status,headers,config){prescreen.data.questions=data,"prescreen"==$state.current.name&&$state.transitionTo("prescreen.questions",{category:"prescreen"})})}]),app.controller("preScreenResultsController",["$scope","prescreen","$location","$state",function($scope,prescreen,$location,$state){document.querySelector(".page-wrapper").scrollIntoView(),$scope.tooltipAccuracy="You will receive more accurate results if you provide more details.",$scope.tooltipExpenses="Expenses are the amount of money you spend on things like rent, utilities, and other costs of living.",$scope.goScreening=function(){$state.transitionTo("screening",{category:"basics",state:prescreen.data.answers.stateId})};var el=document.querySelector(".odometer");od=new Odometer({el:el,value:0}),$scope.foundCount=0;for(var i=0;i<prescreen.data.results.found_programs.length;i++)$scope.foundCount=$scope.foundCount+prescreen.data.results.found_programs[i].count;od.update($scope.foundCount)}]),app.controller("questionnaireBasicController",["$scope","$state","questionnaire",function($scope,$state,questionnaire){$scope.tooltip={race:"Why are we asking? This question is optional, and does not affect your results. Your answer will help us understand how best to reach people who can benefit from this service."},$scope.genders=[{id:"male",name:"Male"},{id:"female",name:"Female"}],$scope.citizens=[{id:"citizen",name:"Citizen"},{id:"legal_resident",name:"Legal Resident"},{id:"qualified_alien",name:"Other Qualified Alien"},{id:"other_citizen",name:"Other"}],$scope.receives=[{id:"medicare_receive",name:"Medicare (currently enrolled or expect to be within the next 3 months)"},{id:"receive_partd",name:"Medicare Prescription Drug Plan (Part D)"},{id:"receive_lis",name:"Extra Help/LIS through Medicare Prescription Drug Coverage"},{id:"med_receive",name:"Medicaid"},{id:"receive_msp",name:"Medicare Savings Programs (QMB, SLMB, or QI)"},{id:"snap_receive",name:"Supplemental Nutrition Assistance Program (SNAP)"},{id:"ssi_receive",name:"Supplemental Security Income (SSI)"},{id:"rec_tricare",name:"TRICARE"},{id:"receive_va",name:"Veteran's Health Care Benefits"},{id:"liheap_receive",name:"Low Income Home Energy Assistance Program (LIHEAP)"},{id:"receive_pub_housing",name:"Public Housing"},{id:"receive_section_8",name:"Housing Choice Vouchers (Section 8)"},{id:"scsep_receive",name:"Senior Community Service Employment Program (SCSEP)"}],$scope.races=[{id:"white",name:"White"},{id:"african_american",name:"Black or African-American"},{id:"american_indian_native_alaskans",name:"American Indian or Alaska Native"},{id:"asian",name:"Asian or Asian-American"},{id:"pacific_islander",name:"Native Hawaiian or Other Pacific Islander"},{id:"hispanic",name:"Hispanic, Latino, or Spanish Origin"},{id:"other_race",name:"Other"}]}]),app.controller("questionnaireController",["$scope","$state","questionnaire",function($scope,$state,questionnaire){$scope.questionnaire=questionnaire,void 0==$scope.questionnaire.request&&($scope.questionnaire.request={}),"questionnaire"==$state.current.name&&$state.transitionTo("questionnaire.basics")}]),app.controller("screeningController",["$rootScope","$scope","$state","prescreen","screening","screeningQuestions",function($rootScope,$scope,$state,prescreen,screening,screeningQuestions){$rootScope.showLoader=!1,void 0==$scope.$root.answers&&($scope.$root.answers=screening.data.answers),void 0==$scope.$root.questions&&($scope.$root.questions=screening.data.questions),void 0!=$state.params.category&&void 0!=$state.params.state?($scope.category=$state.params.category,void 0==$scope.$root.answers[$state.params.category]&&($scope.$root.answers[$state.params.category]=screening.data.answers[$state.params.category]),screeningQuestions.get($state.params.category,prescreen.data.results.screening.id,$state.params.state).success(function(data){screening.data.questions[$state.params.category]=data,$scope.$root.questions[$state.params.category]=data})):$state.transitionTo("screening",{category:"basics",state:prescreen.data.answers.stateId})}]),app.controller("questionnaireFinancesController",["$scope","Income",function($scope,Income){$scope.income_total=function(type){var retValTotal=0,retValUnearned=0;for(var i in $scope.questionnaire.request["finances-income-grid"])0==i.indexOf(type)&&i.indexOf("total_complete")==-1&&i.indexOf("total_unearned")==-1&&(retValTotal+=$scope.questionnaire.request["finances-income-grid"][i],Income.isUnearned(i.replace(type,""))&&(retValUnearned+=$scope.questionnaire.request["finances-income-grid"][i]));return void 0==$scope.questionnaire.request["income-totals"]&&($scope.questionnaire.request["income-totals"]={}),$scope.questionnaire.request["income-totals"][type+"total_complete"]=retValTotal,$scope.questionnaire.request["income-totals"][type+"total_unearned"]=retValUnearned,retValTotal},$scope.assets_total=function(type){var retVal=0;for(var i in $scope.questionnaire.request["finances-assets-grid"])0==i.indexOf(type)&&i.indexOf("total_complete")==-1&&(retVal+=$scope.questionnaire.request["finances-assets-grid"][i]);return void 0==$scope.questionnaire.request["assets-totals"]&&($scope.questionnaire.request["assets-totals"]={}),$scope.questionnaire.request["assets-totals"][type+"total_complete"]=retVal,retVal},$scope.setIncomeSelected=function(index){void 0==$scope.questionnaire.incomes[index].selected?$scope.questionnaire.incomes[index].selected=!0:1==$scope.questionnaire.incomes[index].selected?$scope.questionnaire.incomes[index].selected=!1:$scope.questionnaire.incomes[index].selected=!0},$scope.setAssetsSelected=function(index){void 0==$scope.questionnaire.assets[index].selected?$scope.questionnaire.assets[index].selected=!0:1==$scope.questionnaire.assets[index].selected?$scope.questionnaire.assets[index].selected=!1:$scope.questionnaire.assets[index].selected=!0}}]),app.controller("questionnaireHealthController",["$scope","questionnaire","CronicConditions",function($scope,questionnaire,CronicConditions){$scope.chronicConditions=CronicConditions.getCronicConditions()}]),app.controller("questionnaireHouseholdController",["$scope","questionnaire",function($scope,questionnaire){$scope.housings=[{id:"own_home",name:"Own Home"},{id:"rent_dwelling",name:"Rental"},{id:"own_mobile_home",name:"Own Mobile Home"},{id:"boarding_home",name:"Boarding Home"},{id:"live_with_others",name:"Live with Others"},{id:"nursing_facility",name:"Nursing Facility"},{id:"assisted_living",name:"Assisted Living"},{id:"subsidized_housing",name:"Low-Income Housing"},{id:"homeless_shelter",name:"Homeless or Live in a Shelter"}]}]),app.controller("questionnaireLoaderController",["$scope","$state",function($scope,$state){$(".btns-container").hide(),$(".card-nested").addClass("loader"),$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams,options){$(".btns-container").show(),$(".card-nested").removeClass("loader")})}]),app.controller("questionnairePrescreenResultsController",["$scope","$state","BenefitItems","prescreen",function($scope,$state,BenefitItems,prescreen){var el=document.querySelector(".odometer");od=new Odometer({el:el,value:0});var returned_programs=[];$scope.found_programs=[],$scope.available_fact_sheets={},prescreen.data.results.found_programs.forEach(function(element,index){if(prescreen.data.answers[element.category]){if("bcuqc_category_veteran"==element.category&&"n"==prescreen.data.answers.veteran){var emptyProgram={category:element.category,count:0,programs:[]};$scope.found_programs.push(emptyProgram),prescreen.data.results.found_programs[index]=emptyProgram}else $scope.found_programs.push(element);returned_programs.push(element.category)}$scope.available_fact_sheets[element.category]=[],element.programs.forEach(function(program){$scope.available_fact_sheets[element.category].push(program.code)})}),console.log(encodeURIComponent(JSON.stringify($scope.available_fact_sheets))),$(prescreen.data.screenData.benefits_categories_codes).not(returned_programs).get().forEach(function(element){$scope.found_programs.push({category:element,count:0,programs:[]})}),$scope.foundCount=0;for(var i=0;i<prescreen.data.results.found_programs.length;i++)$scope.foundCount=$scope.foundCount+prescreen.data.results.found_programs[i].count;od.update($scope.foundCount),document.querySelector(".page-wrapper h1").scrollIntoView()}]),app.directive("divProgramsCategory",["BenefitItems","prescreen","$sce",function(BenefitItems,prescreen,$sce){return{restrict:"E",templateUrl:"/content/themes/ncoa/resources/views/directives/program/programs.category.html?"+new Date,link:function(scope,element){scope.benefitItem=BenefitItems.getByCode(scope.found_program.category),scope.stateId=prescreen.data.answers.stateId,scope.defaultLangsPre=window.defaultLangsPre,scope.defaultLangsFull=window.defaultLangsFull,scope.zipcode=prescreen.data.answers.zip},scope:{found_program:"=foundProgram",short:"@",elegible:"@"}}}]),app.directive("divKeyProgram",["prescreen",function(prescreen){return{restrict:"E",templateUrl:"/content/themes/ncoa/resources/views/directives/program/programs.key-program.html?"+new Date,scope:{program:"=program"},link:function(scope,element){scope.stateId=prescreen.data.answers.stateId,scope.zipcode=prescreen.data.answers.zip,scope.subString=function(string){return string.length>70?string.substring(0,70)+"...":string}}}}]),app.directive("divProgramDesc",function(){return{restrict:"E",link:function(scope,element){element.append("<p>"+scope.program_desc+"</p>")},scope:{program_desc:"=programDesc"}}}),app.controller("questionnaireResultsController",["$scope","$state","screening",function($scope,$state,screening){var el=document.querySelector(".odometer");od=new Odometer({el:el,value:0});$scope.foundCount=0;for(var i=0;i<screening.data.results.found_programs.length;i++)$scope.foundCount=$scope.foundCount+screening.data.results.found_programs[i].count;od.update($scope.foundCount),$scope.key_programs=screening.data.results.key_programs,$scope.found_programs=screening.data.results.found_programs,document.querySelector(".page-wrapper h1").scrollIntoView()}]),app.controller("zipCodeController",["$scope","$http","$window","localStorageService","locationFinder","$state",function($scope,$http,$window,localStorageService,locationFinder,$state){$scope.findZip=function(zip){if(5!=zip.length)return void($scope.isZipInvalid=!0);$scope.isZipInvalid=!1,locationFinder.getLocation(zip).success(function(data,status,headers,config){if("OK"==data.status){$scope.isZipInvalid=!0
;for(var i=0;i<data.results[0].address_components.length;i++)for(var j=0;j<data.results[0].address_components[i].types.length;j++)"country"!=data.results[0].address_components[i].types[j]&&"political"!=data.results[0].address_components[i].types[j]||"US"!=data.results[0].address_components[i].short_name||($scope.isZipInvalid=!1),"postal_code"==data.results[0].address_components[i].types[j]&&data.results[0].address_components[i].long_name;$scope.isZipInvalid||(localStorageService.set("v_zipcode",data.results[0].address_components[0].long_name),$window.location.href="/find-my-benefits")}else $scope.isZipInvalid=!0})}}]),app.controller("dobController",["$scope","category","AnswersByCategories",function($scope,category,AnswersByCategories){$scope.calcDob=function(){void 0!=$scope.$root.answers[category.currentCategory()].dob_month&&void 0!=$scope.$root.answers[category.currentCategory()].dob_year&&(AnswersByCategories.setCategory("dob",category.currentCategory(),"integer"),$scope.$root.answers[category.currentCategory()].dob=(new Date).getFullYear()-$scope.$root.answers[category.currentCategory()].dob_year,(new Date).getMonth()+1<$scope.$root.answers[$scope.category].dob_month.id&&($scope.$root.answers[category.currentCategory()].dob=$scope.$root.answers[category.currentCategory()].dob-1))};var yearWatch="$root.answers."+category.currentCategory()+".dob_year";$scope.$watch(yearWatch,function(){$scope.calcDob()});var monthWatch="$root.answers."+category.currentCategory()+".dob_month";$scope.$watch(monthWatch,function(){$scope.calcDob()})}]),app.filter("unsafe",function($sce){return $sce.trustAsHtml});